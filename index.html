<meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>  
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="google-adsense-account" content="ca-pub-5839265106233069">

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5839265106233069"
     crossorigin="anonymous"></script>
  
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nothing Zones</title>
      
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root { 
            --bg: #000; --card: #0c0c0c; --text: #fff; --dot-bg: #250; 
            --border: #1a1a1a; --instr: #bbb; --accent: #ff0000;
            --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        [data-theme="light"] { --bg: #fff; --card: #f5f5f5; --text: #000; --dot-bg: #ddd; --border: #eee; --instr: #333; }
        
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            background: var(--bg); color: var(--text); font-family: 'VT323', monospace; 
            transition: background var(--transition); width: 100%; overflow-x: hidden; min-height: 100vh; 
        }
        
        h1, h2, h3, span, button, select, input, p { font-family: 'VT323', monospace !important; text-transform: uppercase; }

        .stars-container { position: fixed; inset: 0; z-index: -1; background: var(--bg); overflow: hidden; contain: strict; }
        .star { position: absolute; background: white; border-radius: 50%; opacity: 0; will-change: opacity; animation: blink 3s infinite; }
        @keyframes blink { 0%, 100% { opacity: 0; } 50% { opacity: 0.7; } }
        
        .canvas { 
            position: fixed; inset: 0; background-image: radial-gradient(var(--dot-bg) 1.2px, transparent 1.2px); 
            background-size: 32px 32px; z-index: -1; opacity: 0.5; pointer-events: none;
        }

        header { max-width: 1000px; margin: 50px auto 20px; padding: 0 20px; display: flex; justify-content: space-between; align-items: center; }
        .logo h1 { font-size: 3.5rem; letter-spacing: -1px; line-height: 0.9; }
        
        .t-toggle { width: 45px; height: 45px; border-radius: 50%; border: 1px solid var(--border); display: grid; place-items: center; cursor: pointer; background: var(--card); transition: var(--transition); }
        .t-toggle:hover { border-color: var(--text); }

        .bento { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; max-width: 1000px; margin: 0 auto; padding: 0 20px 20px; }
        @media (min-width: 768px) { .bento { grid-template-columns: repeat(3, 1fr); } }

        .tile { background: var(--card); border: 1px solid var(--border); border-radius: 35px; padding: 25px; cursor: pointer; transition: var(--transition); }
        .tile:hover { border-color: #333; transform: translateY(-2px); }
        .tile:active { transform: scale(0.95); }
        .tile h2 { font-size: 2.2rem; }
        .tile p { opacity: 0.4; font-size: 1rem; }
        .full { grid-column: span 2; }
        @media (min-width: 768px) { .full { grid-column: span 1; } }

        .screen { position: fixed; inset: 0; background: rgba(0,0,0,0.92); z-index: 2000; display: none; align-items: flex-end; justify-content: center; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); }
        @media (min-width: 768px) { .screen { align-items: center; } }

        .modal { 
            background: var(--bg); border: 1px solid var(--border); width: 100%; max-width: 600px; 
            border-radius: 40px 40px 0 0; padding: 35px 25px 60px; 
            transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            max-height: 92vh; overflow-y: auto; position: relative; will-change: transform;
        }
        @media (min-width: 768px) { .modal { border-radius: 40px; transform: translateY(0); } }

        .screen.active .modal { transform: translateY(0); }
        .screen.closing .modal { transform: translateY(100%); }

        .close-icon { float: right; font-size: 2.5rem; cursor: pointer; opacity: 0.5; margin-top: -15px; transition: 0.2s; }
        .close-icon:hover { opacity: 1; color: var(--text); }

        /* NAYA: SW Display Style */
        .sw-display { display: none; align-items: center; gap: 20px; margin: 15px 0; padding: 15px; background: var(--card); border-radius: 25px; border: 1px solid var(--border); animation: fadeIn 0.3s ease; }
        .sw-img-box { width: 70px; height: 90px; border-radius: 12px; overflow: hidden; background: var(--card); flex-shrink: 0; border: px solid var(--border); }
        .sw-img-box img { width: 120%; height: 100%; object-fit: cover; }
        .sw-info h3 { font-size: 1.8rem; line-height: 1; margin-bottom: 5px; }

        .dot-arrow { width: 20px; height: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 1px; }
        .dot-row { display: flex; gap: 2px; }
        .dot { width: 2.5px; height: 2.5px; background: var(--text); border-radius: 50%; }

        .up-box { background: var(--card); border: 1px solid var(--border); border-radius: 20px; padding: 15px; margin-bottom: 12px; border-left: 4px solid #fffff; }
        .up-box h4 { 
    font-size: 1.4rem; 
    color: var(--text); /* <-- Yeh line change karni hai */
}
        .up-box p { font-size: 0.9rem; opacity: 0.5; margin-top: 4px; text-transform: none; }

        .input-group { position: relative; width: 100%; margin-bottom: 18px; display: flex; align-items: center; }
        select, input.imei-box { width: 100%; padding: 20px; background: var(--card); border: 1px solid var(--border); color: var(--text); border-radius: 22px; font-size: 1.6rem; outline: none; appearance: none; }
        input.imei-box { text-align: center; letter-spacing: 2px; }
        .arrow-wrapper { position: absolute; right: 25px; pointer-events: none; color: #ffffff; }

        .btn { 
            position: relative; width: 100%; padding: 20px; border-radius: 22px; border: none; 
            background: var(--text); color: var(--bg); font-size: 1.6rem; 
            cursor: pointer; font-weight: bold; margin-top: 5px; overflow: hidden;
            display: flex; justify-content: center; align-items: center; transition: 0.2s;
        }
        .progress-bar { position: absolute; left: 0; top: 0; height: 100%; width: 0%; background: rgba(128,128,128,0.5); z-index: 1; }
        .btn-text { position: relative; z-index: 2; }

        .guide-box { border: 1px solid var(--border); border-radius: 22px; margin-bottom: 15px; overflow: hidden; margin-top: 20px; background: var(--card); }
        .guide-header { padding: 20px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
        .guide-content { max-height: 0; overflow: hidden; transition: 0.4s ease; padding: 0 20px; opacity: 0; }
        .guide-content.open { max-height: 500px; padding: 20px; opacity: 1; border-top: 1px solid var(--border); }
        .guide-content p { color: var(--instr); line-height: 1.4; text-transform: none; font-size: 1.1rem; margin-bottom: 15px; }

        .wp-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 20px; }
        .wp-card { height: 280px; background: #111; border-radius: 25px; position: relative; overflow: hidden; border: 1px solid var(--text); }
        .wp-card img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; display: block; }
        .wp-overlay { position: absolute; bottom: 0; width: 100%; padding: 10px; background: linear-gradient(transparent, rgba(0,0,0,0.9)); }
        
        .detail-card { background: var(--card); border: 1px solid var(--border); border-radius: 30px; padding: 25px; margin-top: 20px; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .sc-badge { background: #222; color: #888; padding: 4px 10px; border-radius: 8px; font-size: 0.9rem; margin-bottom: 10px; display: inline-block; border: 1px solid var(--border); }
        .card-row { display: flex; justify-content: space-between; align-items: center; border-top: 1px solid var(--border); padding-top: 15px; margin-top: 15px; gap: 10px; }

        .pg-btn { background: var(--card); border: 1px solid var(--border); padding: 22px; border-radius: 25px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; cursor: pointer; transition: 0.2s; }
        
        footer { text-align: center; padding: 30px; opacity: 0.3; font-size: 0.8rem; letter-spacing: 1px; }
    </style>
</head>
<body>
<div id="wrapper" class="entrance-wrapper">
    <div class="wrapper-content">
        <h1 class="nothing-logo">NOTHING ZONES</h1>
        <div class="loader-bar"></div>
    </div>
</div>

<div class="stars-container" id="starField"></div>
<div class="canvas"></div>

<header>
    <div class="logo">
        <p style="opacity: 0.4; letter-spacing: 2px;">ONLY FOR FANS</p>
        <h1>NOTHING<br>ZONES</h1>
    </div>
    <div class="t-toggle" onclick="toggleTheme()"><i class="fa-solid fa-moon" id="t-icon"></i></div>
</header>

<div class="bento">
    <div class="tile full" onclick="openScreen('upScr')"><h1>WEBSITE</h1><p>WHAT'S NEW ADDED</p></div>
       <div class="tile full" onclick="openScreen('musicScr')"><h1>RINGTONE</h1><p>DOWNLOAD MP3</p></div>
    <div class="tile full" onclick="openScreen('pgScr')"><h1>PLAYGROUND</h1><p>presets WIDGETs APPs</p></div>
    <div class="tile full" onclick="openScreen('swScr')"><h1>SOFTWARE </h1><p>NOS ZIP FILE</p></div>
    <div class="tile full" onclick="openScreen('wpScr')"><h1>WALLPAPER </h1><p>EXCLUSIVe Collection</p></div>
    <div class="tile full" onclick="openScreen('scScr')"><h1>SERVICE </h1><p>LOCATE CENTERS</p></div>
 <div class="tile full" onclick="openScreen('feedbackScr')"><h1>COMMUNITY </h1><p>FEEDBACK & SUGGESTIONS</p></div>

</div>
<!-- MODALS -->
<div id="aboutScr" class="screen">
  <div class="modal">
    <span class="close-icon" onclick="closeScreen('aboutScr')">√ó</span>
    <h2>ABOUT NOTHING ZONES</h2>
    <div class="detail-card" style="text-align: left; line-height: 1.6; max-height: 400px; overflow-y: auto;">
      <h3>Who We Are</h3>
      <p>Welcome to <b>Nothing Zones/b>, the premier independent digital hub dedicated to the Nothing ecosystem. Established in 2024, we are a collective of tech enthusiasts, developers, and designers who share a passion for transparent design and minimalism.</p>
      
      <h3>What We Do</h3>
      <p>We aim to bridge the gap between Nothing Technology's innovative hardware and the end-user experience. Our platform serves as a central repository for:</p>
      <ul>
        <li><b>Firmware Archives:</b> Safe and verified download links for Nothing OS (Stable & Beta).</li>
        <li><b>Customization:</b> Curated stock wallpapers, ringtones, and glyph interface tools.</li>
        <li><b>Development:</b> Guides on rooting, custom ROMs, and Gcam ports specifically optimized for Phone (1), Phone (2), and Phone (2a).</li>
      </ul>

      <h3>Our Values</h3>
      <p>We believe in open-source collaboration and community support. Every file and guide shared on this platform is tested by our team to ensure safety and reliability.</p>
    </div>
  </div>
</div>

<div id="privacyScr" class="screen">
  <div class="modal">
    <span class="close-icon" onclick="closeScreen('privacyScr')">√ó</span>
    <h2>PRIVACY POLICY</h2>
    <div class="detail-card" style="text-align: left; max-height: 400px; overflow-y: auto;">
      <p><b>Last Updated: January 10, 2026</b></p>
      <p>At Nothing Zones, the privacy of our visitors is of extreme importance to us. This Privacy Policy document outlines the types of personal information is received and collected by Nothing Zones and how it is used.</p>
      
      <h3>1. Log Files & Analytics</h3>
      <p>Like many other Web sites, Nothing Zones makes use of log files. The information inside the log files includes internet protocol (IP) addresses, type of browser, Internet Service Provider (ISP), date/time stamp, referring/exit pages, and number of clicks to analyze trends, administer the site, track user's movement around the site, and gather demographic information. IP addresses and other such information are not linked to any information that is personally identifiable.</p>

      <h3>2. Cookies and Web Beacons</h3>
      <p>We use cookies to store information about visitors' preferences, to record user-specific information on which pages the site visitor accesses or visits, and to personalize or customize our web page content based upon visitors' browser type or other information that the visitor sends via their browser.</p>

      <h3>3. Google DoubleClick DART Cookie</h3>
      <p>Google is a third-party vendor on our site. It uses cookies, known as DART cookies, to serve ads to our site visitors based upon their visit to our site and other sites on the internet. However, visitors may choose to decline the use of DART cookies by visiting the Google ad and content network Privacy Policy at the following URL ‚Äì <a href="https://policies.google.com/technologies/ads" target="_blank">https://policies.google.com/technologies/ads</a></p>

      <h3>4. GDPR Data Protection Rights</h3>
      <p>We would like to make sure you are fully aware of all of your data protection rights. Every user is entitled to the following: The right to access, rectification, erasure, restrict processing, object to processing, and data portability.</p>

      <h3>5. CCPA Privacy Rights (Do Not Sell My Personal Information)</h3>
      <p>Under the CCPA, among other rights, California consumers have the right to request that a business that collects a consumer's personal data disclose the categories and specific pieces of personal data that a business has collected about consumers.</p>
    </div>
  </div>
</div>

<div id="disclaimerScr" class="screen">
  <div class="modal">
    <span class="close-icon" onclick="closeScreen('disclaimerScr')">√ó</span>
    <h2>LEGAL DISCLAIMER</h2>
    <div class="detail-card" style="text-align: left; max-height: 400px; overflow-y: auto;">
      <h3 style="color: #D71921;">Affiliation Disclaimer</h3>
      <p><b>Nothing Zones</b> is an independent fan-made website. We are <b>NOT</b> affiliated, associated, authorized, endorsed by, or in any way officially connected with <b>Nothing Technology Limited</b>, <b>CMF by Nothing</b>, or any of their subsidiaries or its affiliates. The official Nothing website can be found at <a href="https://nothing.tech" target="_blank">nothing.tech</a>.</p>
      
      <h3>Intellectual Property Rights</h3>
      <p>The names "Nothing", "Phone (1)", "Phone (2)", "Ear (1)", and related marks, logos, and emblems are registered trademarks of their respective owners. Their use on this website is for identification and educational purposes only, under the doctrine of <b>Fair Use</b>.</p>

      <h3>External Links Disclaimer</h3>
      <p>This website may contain links to external websites that are not provided or maintained by or in any way affiliated with us. Please note that the Nothing Zones does not guarantee the accuracy, relevance, timeliness, or completeness of any information on these external websites.</p>

      <h3>No Professional Advice</h3>
      <p>The information contained on this website is provided for general information and educational purposes only. It is not a substitute for professional technical advice. Downloading custom firmware (ROMs), rooting tools, or beta software involves risk. <b>We are not responsible for bricked devices, dead SD cards, or voided warranties.</b> Proceed at your own risk.</p>
    </div>
  </div>
</div>

<div id="contactScr" class="screen">
  <div class="modal">
    <span class="close-icon" onclick="closeScreen('contactScr')">√ó</span>
    <h2>CONTACT & SUPPORT</h2>
    <div class="detail-card" style="text-align: left;">
      <p>We value your feedback and inquiries. Please direct your messages to the appropriate department below:</p>
      
      <div style="margin-top: 20px; border-bottom: 1px solid #333; padding-bottom: 10px;">
        <h3 style="margin:0; font-size: 16px; color: #aaa;">General Inquiries & Feedback</h3>
        <p style="margin: 5px 0;">For suggestions regarding the website or community.</p>
        <p>üìß <a href="mailto:rohub735@gmail.com" style="color: white; font-weight: bold;">rohub735@gmail.com</a></p>
      </div>

      <div style="margin-top: 15px; border-bottom: 1px solid #333; padding-bottom: 10px;">
        <h3 style="margin:0; font-size: 16px; color: #aaa;">DMCA / Copyright</h3>
        <p style="margin: 5px 0;">If you believe any content violates your copyright, please contact us immediately for removal.</p>
        <p>Subject Line: <b>"Copyright Takedown Request"</b></p>
      </div>

      <div style="margin-top: 15px;">
        <h3 style="margin:0; font-size: 16px; color: #aaa;">Advertising & Partnership</h3>
        <p style="margin: 5px 0;">For banner ads or sponsored post opportunities.</p>
      </div>

      <p style="font-size: 12px; margin-top: 20px; color: #666;">We aim to respond to all legitimate emails within 24-48 business hours.</p>
    </div>
  </div>
</div>

<!-- FOOTER -->
<footer>
  <div class="footer-links">
    <a href="javascript:void(0)" onclick="openScreen('aboutScr')">ABOUT</a>
    <a href="javascript:void(0)" onclick="openScreen('privacyScr')">PRIVACY</a>
    <a href="javascript:void(0)" onclick="openScreen('contactScr')">CONTACT</a>
    <a href="javascript:void(0)" onclick="openScreen('disclaimerScr')">DISCLAIMER</a>
  </div>
  <p style="opacity:0.9; font-size:12px;">
    NOTHING ZONES ¬© 2026<br>
    DESIGNED FOR THE COMMUNITY
  </p>
</footer>

<!-- STYLES -->
<style>
.screen{
  display:none;
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  background:rgba(0,0,0,0.8);
  z-index:1000;
  justify-content:center;
  align-items:center;
  display:flex;
}
.modal{
  background:var(--card);
  padding:20px;
  border-radius:8px;
  max-width:500px;
  width:90%;
  position:relative;
}
.detail-card p{
  margin:10px 0;
}
.footer-links{
  display:flex;
  justify-content:center;
  gap:20px;
  margin-bottom:10px;
}

footer a{color:var(--text);}
footer a:hover{color:#fff;}
</style>

<!-- SCRIPT -->
<script>
function openScreen(id){
  document.getElementById(id).style.display='flex';
}
function closeScreen(id){
  document.getElementById(id).style.display='none';
}
</script>

<div id="upScr" class="screen"><div class="modal">
    <span class="close-icon" onclick="closeScreen('upScr')">√ó</span>
    <h2>WEBSITE LOGS</h2>
    <div style="margin-top:20px;">
        <div class="up-box"><h4>COMMUNITY BOARD</h4><p>Now you can share feedback, ideas & suggestions.</p></div>
        <div class="up-box"><h4>NEW RINGTONE PLAYER</h4><p>Ad-free nonstop ringtones & background Playble.</p></div>
        <div class="up-box"><h4>NEW WALLPAPERS</h4><p>Added high-quality art works in the gallery.</p></div>
        <div class="up-box"><h4>SOFTWARE UPDATE</h4><p>Now supports all phones with latest NOS ZIPs.</p></div>
        <div class="up-box"><h4>SERVICE DATABASE</h4><p>Call or open maps directly, no more hassle.</p></div>
        <div class="up-box"><h4>ADDED FEATURES</h4><p>Auto theme support with manual control.</p></div>
    </div>
</div></div>

<div id="feedbackScr" class="screen">
    <div class="modal" style="max-width: 500px; height: 85vh; display: flex; flex-direction: column;">
        <span class="close-icon" onclick="closeScreen('feedbackScr')">√ó</span>
        <h2 style="margin-bottom: 5px;">COMMUNITY BOARD</h2>
        <p style="opacity: 0.4; font-size: 0.8rem; margin-bottom: 15px;">PUBLIC FEEDBACK & CHAT</p>
        
        <div id="msgBoard" style="flex: 1; overflow-y: auto; padding: 10px; display: flex; flex-direction: column; gap: 15px; scroll-behavior: smooth;">
            </div>

        <div style="background: var(--card); border: 1px solid var(--border); border-radius: 30px; padding: 5px 5px 5px 15px; display: flex; align-items: center; margin-top: 15px;">
            <input type="text" id="userMsg" placeholder="SHARE SUGGESTION..." 
                style="flex: 1; background: transparent; border: none; color: var(--text); outline: none; font-family: 'VT323' !important; font-size: 1.2rem;">
            <button onclick="sendMsg()" style="width: 45px; height: 45px; border-radius: 50%; background: var(--text); color: var(--bg); border: none; cursor: pointer;">
                <i class="fa-solid fa-arrow-up"></i>
            </button>
        </div>
    </div>
</div>

<div id="musicScr" class="screen">
    <div class="modal">
        <span class="close-icon" onclick="handleMusicClose()">√ó</span>
        <h2 style="margin-bottom:20px;">RINGTONE PLAYER</h2>
        
        <div class="music-ui">
            <div class="search-box-m" style="display: flex; gap: 10px; margin-bottom: 20px;">
                <input type="text" id="mQuery" placeholder="SEARCH SONG..." style="flex:1; padding:15px; background:var(--card); border:1px solid var(--border); color:#fff; border-radius:15px;">
                <button class="go-btn" id="mSearchBtn" onclick="searchMusic()" style="width:50px; border-radius:15px; background:#fff; color:#000; border:none; cursor:pointer;">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </button>
            </div>
        </div>
            
        <div id="music-card" style="display: none; text-align: center;">
            <img src="" id="mArt" class="disc" style="width: 180px; height: 180px; border-radius: 50%; border: 2px solid var(--accent); object-fit: cover;">
            <h3 id="mTitle" style="margin-top:15px;">TITLE</h3>
            <p id="mArtist" style="opacity:0.5;">ARTIST</p>
            
            <div class="m-ctrls" style="display: flex; justify-content: center; gap: 30px; font-size: 1.8rem; margin: 20px 0;">
                <i class="fa-solid fa-backward-step" onclick="prevSong()" style="cursor:pointer"></i>
                <span id="play-pause" onclick="togglePlay()" style="cursor:pointer">
                    <i class="fa-solid fa-circle-play"></i>
                </span>
                <i class="fa-solid fa-forward-step" onclick="nextSong()" style="cursor:pointer"></i>
            </div>
            
            <button class="btn" id="mDownloadBtn" onclick="downloadCurrentSong()">DOWNLOAD MP3</button>
        </div>
        <audio id="mPlayer" onended="nextSong()"></audio>
    </div>
</div>

<div id="mini-player" onclick="restorePlayer()" 
     style="position:absolute; top:85; right:90px; width:45px; height:45px; 
            border-radius:50%; border:2px solid var(--accent); overflow:hidden; 
            cursor:pointer; display:none; z-index:10; background:#000;">
    <img src="" id="mini-art" class="spinning" style="width:100%; height:100%; object-fit:cover;">
</div>

<div id="imeiScr" class="screen">
    <div class="modal">
        <span class="close-icon" onclick="closeScreen('imeiScr')">√ó</span>
        <h2>DEVICE VERIFY</h2>
        <p style="opacity:0.5; margin-bottom:20px;">DIAL *#06# TO FIND YOUR IMEI</p>
        
        <div class="input-group">
            <!-- type="text" ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§§‡§æ‡§ï‡§ø 15 ‡§°‡§ø‡§ú‡§ø‡§ü ‡§∏‡§π‡•Ä ‡§∏‡•á ‡§ü‡§æ‡§á‡§™ ‡§π‡•ã‡§Ç ‡§î‡§∞ maxlength ‡§≤‡§ó‡§æ ‡§¶‡•Ä -->
            <input type="text" id="imeiInput" class="imei-box" placeholder="ENTER 15 DIGIT IMEI" maxlength="15" oninput="this.value = this.value.replace(/[^0-9]/g, '')">
        </div>

        <button class="btn" onclick="checkImei(this)" style="position: relative; overflow: hidden;">
            <div class="progress-bar"></div>
            <span class="btn-text">IDENTIFY DEVICE</span>
        </button>

        <!-- ‡§∞‡§ø‡§ú‡§≤‡•ç‡§ü ‡§Ø‡§π‡§æ‡§Å ‡§∂‡•ã ‡§π‡•ã‡§ó‡§æ -->
        <div id="imeiResult" style="margin-top: 20px;"></div>
    </div>
</div>

<div id="swScr" class="screen"><div class="modal">
    <span class="close-icon" onclick="closeScreen('swScr')">√ó</span>
    <h2>SYSTEM UPDATE</h2>
    
    <div class="guide-box">
        <div class="guide-header" onclick="toggleAccordion()">
            <span>HOW TO UPDATE?</span>
            <div class="arrow-wrapper" style="position:static; color:#ffffff"><div class="dot-arrow"><div class="dot-row"><div class="dot"></div><div class="dot" style="visibility:hidden"></div><div class="dot"></div></div><div class="dot-row"><div class="dot"></div><div class="dot"></div></div><div class="dot-row"><div class="dot"></div></div></div></div>
        </div>
        <div class="guide-content" id="accContent">
            <p>1. DOWNLOAD THE BETA HUB TOOL APK.<br>2. CREATE "OTA" FOLDER IN INTERNAL STORAGE AND PASTE OTA ZIP INSIDE .<br>3. SETTING - SYSTEM - BETA HUB - IMPORT FILE - ZIP - UPDATE.</p>
            <button class="btn" onclick="runDownload(this, 'BETA_TOOL')"><div class="progress-bar"></div><span class="btn-text">DOWNLOAd BETA TOOL</span></button>
        </div>
    </div>

    <div class="sw-display" id="swDisplay">
        <div class="sw-img-box"><img src="" id="swPhoneImg"></div>
        <div class="sw-info">
            <h2 id="swPhoneTitle">DEVICE</h2>
            <p style="opacity:0.5; font-size:0.9rem;"> Official ota Firmware Zip</p>
        </div>
    </div>

    <div class="input-group">
        <select id="swSelect" onchange="showLogs()">
            <option value="">SELECT Your Device</option>
            
<option value="p1">NOTHING PHONE (1)</option>
<option value="p2">NOTHING PHONE (2)</option>
<option value="p2a">NOTHING PHONE (2A)</option>
<option value="p2aplus">NOTHING PHONE (2A) PLUS</option>
<option value="p3">NOTHING PHONE (3)</option>
<option value="p3a">NOTHING PHONE (3A)</option>
<option value="p3apro">NOTHING PHONE (3A) PRO</option>
<option value="p3alite">NOTHING PHONE (3A) LITE</option>
<option value="cmf1">CMF PHONE 1</option>
<option value="cmf2pro">CMF PHONE 2 PRO</option>
    </select>
        <div class="arrow-wrapper"><div class="dot-arrow"><div class="dot-row"><div class="dot"></div><div class="dot" style="visibility:hidden"></div><div class="dot"></div></div><div class="dot-row"><div class="dot"></div><div class="dot"></div></div><div class="dot-row"><div class="dot"></div></div></div></div>
    </div>

    <div id="logBox" style="display:none;" class="detail-card">
        <h3>CHANGELOG:</h3>
        <ul id="swList" style="margin:15px 0; opacity:0.7; list-style: inside; text-transform: none;"></ul>
        <button class="btn" onclick="runDownload(this, 'OTA_ZIP')"><div class="progress-bar"></div><span class="btn-text">DOWNLOAD OTA ZIP</span></button>
    </div>
</div></div>

<div id="pgScr" class="screen"><div class="modal">
    <span class="close-icon" onclick="closeScreen('pgScr')">√ó</span>
    <h2>PLAYGROUND</h2>
    <div style="margin-top:20px;">
        <div class="pg-btn" onclick="openScreen('presetScr')"><span>CAMERA PRESETS</span><i class="fa-solid fa-camera"></i></div>
        <div class="pg-btn" onclick="alert('Coming Soon')"><span>COMMUNITY WIDGETS</span><i class="fa-solid fa-shapes"></i></div>
        <div class="pg-btn" onclick="alert('Coming Soon')"><span>COMMUNITY APPS</span><i class="fa-solid fa-mobile"></i></div>
    </div>
</div></div>

<div id="presetScr" class="screen"><div class="modal">
    <span class="close-icon" onclick="closeScreen('presetScr')">√ó</span>
    <h2>CAMERA PRESETS</h2>
    
    <p style="opacity:0.5; margin-bottom:10px;">EXCLUSIVE PRESETS</p>
    <div class="wp-grid" id="presetGrid"></div>
</div></div>

<div id="wpScr" class="screen">
    <div class="modal">
        <span class="close-icon" onclick="closeScreen('wpScr')">√ó</span>
        <h2>GALLERY</h2>
        
        <div onclick="openScreen('aiWpScr')" style="
            background: var(--text); 
            border: 1px solid var(--border); 
            border-radius: 20px; 
            padding: 16px; 
            margin-bottom: 15px; 
            cursor: pointer; 
            display: flex; 
            justify-content: space-between; 
            align-items: center;">
            
            <span style="color: var(--bg); font-weight: bold; font-size: 1.2rem;"> CREATE WITH AI</span>
            <i class="fa-solid fa-wand-magic-sparkles" style="color: var(--bg);"></i>
        </div>

        <div class="wp-grid" id="wallpaperGrid"></div>
    </div>
</div>
<div id="aiWpScr" class="screen">
    <div class="modal">
        <span class="close-icon" onclick="closeScreen('aiWpScr')">√ó</span>
        
        <h2 style="margin-bottom: 15px;">AI STUDIO</h2>
        
        <div class="input-group">
            <input type="text" id="aiPrompt" class="imei-box" placeholder="Typing..." style="text-align: left;">
        </div>

        <div class="input-group">
            <select id="aiRatio">
                <option value="9:16">MOBILE (9:16)</option>
                <option value="16:9">PC (16:9)</option>
                <option value="1:1">SQUARE (1:1)</option>
            </select>
            <div class="arrow-wrapper"><div class="dot-arrow"><div class="dot-row"><div class="dot"></div><div class="dot" style="visibility:hidden"></div><div class="dot"></div></div><div class="dot-row"><div class="dot"></div><div class="dot"></div></div><div class="dot-row"><div class="dot"></div></div></div></div>
        </div>

        <button class="btn" id="genBtn" onclick="generateAIWall()">
            <div class="progress-bar"></div>
            <span class="btn-text">GENERATE</span>
        </button>

        <div id="aiResult" style="margin-top: 20px; display: none;">
            <div class="wp-card" style="height: 400px; border: 1px solid var(--border);">
                <img id="aiImg" src="" style="width: 100%; height: 100%; object-fit: cover;">
                <div class="wp-overlay">
                    <button class="btn" onclick="downloadAIWall(this)">
                        <div class="progress-bar"></div><span class="btn-text">DOWNLOAD</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>




<div id="scScr" class="screen"><div class="modal">
    <span class="close-icon" onclick="closeScreen('scScr')">√ó</span>
    <h2>SERVICE CENTERS</h2>
    <div class="input-group" style="margin-top:20px;">
      
        <select id="state" onchange="loadCities()"><option value="">SELECT STATE</option>
        
<option value="ANDHRA PRADESH">ANDHRA PRADESH</option>
<option value="ASSAM">ASSAM</option>
<option value="BIHAR">BIHAR</option>
<option value="CHANDIGARH">CHANDIGARH</option>
<option value="CHHATTISGARH">CHHATTISGARH</option>
<option value="DELHI">DELHI</option>
<option value="GOA">GOA</option>
<option value="GUJARAT">GUJARAT</option>
<option value="HARYANA">HARYANA</option>
<option value="HIMACHAL PRADESH">HIMACHAL PRADESH</option>
<option value="JAMMU & KASHMIR">JAMMU & KASHMIR</option>
<option value="JHARKHAND">JHARKHAND</option>
<option value="KARNATAKA">KARNATAKA</option>
<option value="KERALA">KERALA</option>
<option value="MADHYA PRADESH">MADHYA PRADESH</option>
<option value="MAHARASHTRA">MAHARASHTRA</option>
<option value="MEGHALAYA">MEGHALAYA</option>
<option value="NAGALAND">NAGALAND</option>
<option value="ODISHA">ODISHA</option>
<option value="PUDUCHERRY">PUDUCHERRY</option>
<option value="PUNJAB">PUNJAB</option>
<option value="RAJASTHAN">RAJASTHAN</option>
<option value="TAMIL NADU">TAMIL NADU</option>
<option value="TELANGANA">TELANGANA</option>
<option value="TRIPURA">TRIPURA</option>
<option value="UTTAR PRADESH">UTTAR PRADESH</option>
<option value="UTTARAKHAND">UTTARAKHAND</option>
<option value="WEST BENGAL">WEST BENGAL</option>

        
        
        </select>
        <div class="arrow-wrapper"><div class="dot-arrow"><div class="dot-row"><div class="dot"></div><div class="dot" style="visibility:hidden"></div><div class="dot"></div></div><div class="dot-row"><div class="dot"></div><div class="dot"></div></div><div class="dot-row"><div class="dot"></div></div></div></div>
    </div>
    <div class="input-group">
        <select id="city" onchange="showDetails()" style="display:none"></select>
        <div class="arrow-wrapper" id="cityArrow" style="display:none"><div class="dot-arrow"><div class="dot-row"><div class="dot"></div><div class="dot" style="visibility:hidden"></div><div class="dot"></div></div><div class="dot-row"><div class="dot"></div><div class="dot"></div></div><div class="dot-row"><div class="dot"></div></div></div></div>
    </div>
    <div id="scInfo"></div>
</div></div>

<script>
    // 1. GLOBAL CONFIGURATION
    const CONFIG = {
        BETA_TOOL_URL: "https://github.com/nothingcommunity/Testing/raw/refs/heads/main/Apps/Beta%20Updates%20Hub.apk",
        
        // Software Data ab GitHub se aayega, isliye yahan empty rakha hai
        SOFTWARE: {}, 
        
        NOTHING_TAC: {
            "350778": "NOTHING PHONE (1)"
        },
        
        // Service Centers Data (Global Placeholder)
        SERVICE_DB: {},
        
        // Wallpapers Data (Global Placeholder)
        WALLPAPERS: []
    };

    // 2. FETCH SOFTWARE DATA FROM GITHUB
    async function initSoftwareData() {
        // Yeh aapka Raw Link hai (Main branch se linked)
        const url = "https://raw.githubusercontent.com/nothingcommunity/Testing/main/Software/software.json";
        
        try {
            const response = await fetch(url, { cache: "no-cache" }); // no-cache taaki latest update mile
            if (!response.ok) throw new Error("Network Response Fail");
            
            const data = await response.json();
            
            // JSON structure check karke assign karna
            if (data.SOFTWARE) {
                CONFIG.SOFTWARE = data.SOFTWARE;
                console.log("Software Data Loaded ‚úÖ", CONFIG.SOFTWARE);
            }
        } catch (err) {
            console.error("Software Fetch Error ‚ùå:", err);
            // Error handling: Agar load na ho toh user ko batayein
            const list = document.getElementById('swList');
            if(list) list.innerHTML = "<li>Failed to load updates. Check connection.</li>";
        }
    }

    // 3. SHOW LOGS FUNCTION (Updated to work with fetched data)
    function showLogs() {
        const m = document.getElementById('swSelect').value;
        const box = document.getElementById('logBox');
        const disp = document.getElementById('swDisplay');
        const img = document.getElementById('swPhoneImg');
        const title = document.getElementById('swPhoneTitle');
        const list = document.getElementById('swList');

        // Agar koi device select nahi kiya ya data load nahi hua
        if(!m || !CONFIG.SOFTWARE[m]) { 
            box.style.display = 'none'; 
            disp.style.display = 'none'; 
            return; 
        }
        
        const data = CONFIG.SOFTWARE[m];
        
        // UI Update
        img.src = data.img;
        title.innerText = data.disp;
        disp.style.display = 'flex';
        
        // Changelogs Update
        if (data.logs && Array.isArray(data.logs)) {
            list.innerHTML = data.logs.map(l => `<li>${l}</li>`).join('');
        } else {
            list.innerHTML = "<li>Details not available</li>";
        }
        
        box.style.display = 'block';
    }

    // 4. DOWNLOAD FUNCTION (Handles both Tools & OTA Zips)
    function runDownload(btn, type) {
        const bar = btn.querySelector('.progress-bar');
        const txt = btn.querySelector('.btn-text');
        const oldTxt = txt.innerText;
        
        let url = "#";
        
        if (type === 'BETA_TOOL') {
            url = CONFIG.BETA_TOOL_URL;
        } else if (type === 'OTA_ZIP') {
            const selectedDevice = document.getElementById('swSelect').value;
            // Safe check: Agar data load nahi hua toh crash nahi hoga
            url = CONFIG.SOFTWARE[selectedDevice]?.url || "#";
        }

        if(url === "#" || !url) {
            alert("LINK NOT AVAILABLE YET");
            return;
        }

        // Animation
        btn.style.pointerEvents = 'none'; 
        txt.innerText = 'STARTING...';
        bar.style.transition = 'width 2s linear'; 
        bar.style.width = '100%';
        
        setTimeout(() => {
            window.open(url, '_blank');
            txt.innerText = "OPENING...";
            setTimeout(() => { 
                bar.style.transition = 'none'; 
                bar.style.width = '0%'; 
                txt.innerText = oldTxt; 
                btn.style.pointerEvents = 'all'; 
            }, 1000);
        }, 2000);
    }

    // 5. INITIALIZATION
    window.addEventListener('load', () => {
        initSoftwareData(); // Software Data Fetch karein
        
        // Aapke baaki init functions (agar hain)
        if(typeof initServiceData === 'function') initServiceData();
        if(typeof createStars === 'function') createStars();
        if(typeof applyAutoTheme === 'function') applyAutoTheme();
        
        // Wrapper Animation Remove
        const wrapper = document.getElementById('wrapper');
        if(wrapper) {
            setTimeout(() => {
                wrapper.classList.add('exit');
                setTimeout(() => { wrapper.style.display = 'none'; }, 1300);
            }, 2000);
        }
    });

    // Baaki helper functions (toggleTheme, openScreen, etc.) niche rehne dein...
    // ...
        // === FIX: HOW TO UPDATE ACCORDION ===
    function toggleAccordion() {
        const content = document.getElementById('accContent');
        const arrow = document.querySelector('.guide-header .arrow-wrapper');
        
        if (content) {
            // Content kholne/band karne ke liye
            content.classList.toggle('open');
            
            // Optional: Agar arrow ko rotate karna hai (CSS handle karega agar hai to)
            if(arrow) {
                arrow.style.transform = content.classList.contains('open') ? 'rotate(180deg)' : 'rotate(0deg)';
                arrow.style.transition = '0.3s ease';
            }
        }
    }

</script>


</script>
</body>
</html>
<style>.moon {
    position: fixed;
    width: 80px;
    height: 80px;
    top: 10%;
    right: 15%;
    background: #d1d1d1;
    border-radius: 50%;
    z-index: -1;
    /* Moon ke gaddhe (Craters) aur shadow ka effect */
    box-shadow: 
        inset -15px -15px 30px rgba(0,0,0,0.5), 
        0 0 20px rgba(255,255,255,0.2);
    background-image: 
        radial-gradient(circle at 30% 30%, #adadad 10%, transparent 15%),
        radial-gradient(circle at 60% 70%, #adadad 8%, transparent 12%),
        radial-gradient(circle at 20% 75%, #adadad 5%, transparent 10%);
}



/* 1. Theme Variables Fix */
:root { 
    --bg: #000; --card: #0c0c0c; --text: #fff; --dot-bg: #222; 
    --border: #1a1a1a; --accent: #ff0000;
}
[data-theme="light"] { 
    --bg: #ffffff; --card: #f2f2f2; --text: #000; --dot-bg: #ddd; --border: #e0e0e0; 
}


.tile.reveal-visible {
    opacity: 1 !important;
    transform: translateY(0) scale(1) !important;
}

/* 3. Screen/Modal Fix (Gayab nahi hoga) */
.screen {
    position: fixed; inset: 0; 
    background: rgba(0,0,0,0.8); 
    backdrop-filter: blur(15px);
    z-index: 9999;
    display: none; /* JS handle karega */
    opacity: 0;
    transition: opacity 0.4s ease;
    align-items: center; justify-content: center;
}

.screen.active {
    display: flex !important;
    opacity: 1;
}

.modal {
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 35px;
    padding: 30px;
    width: 90%; max-width: 500px;
    transform: scale(0.8) translateY(50px);
    transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.screen.active .modal {
    transform: scale(1) translateY(0);
}
</style><script>    function showDetails() {
        const s = document.getElementById('state').value;
        const c = document.getElementById('city').value;
        if(!c) return;
        const d = CONFIG.SERVICE_DB[s][c];

        document.getElementById('scInfo').innerHTML = `
            <div class="detail-card">
                <div style="display: flex; justify-content: flex-end;">
                    <span class="sc-badge">ID: ${d.c}</span>
                </div>

                <h3>${d.n}</h3>
                <p style="text-transform:none; opacity:0.8; margin:12px 0;">${d.a}</p>
                
                <p>TIMING: ${d.t}</p>
                <p style="margin-top:5px;">CLOSED: ${d.o}</p>

                <div class="card-row" style="margin-top:15px; display: flex; justify-content: space-between;">
                    
                    <button class="btn" style="width:48%; display: flex; align-items: center; justify-content: center; gap: 10px;" onclick="window.open('tel:${d.p}')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/></svg>
                        CALL
                    </button>

                    <button class="btn" style="width:48%; display: flex; align-items: center; justify-content: center; gap: 10px;" onclick="window.open('${d.m}')">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
                        MAPS
                    </button>

                </div>
            </div>`;
    }
function createMoon() {
    const moon = document.createElement('div');
    
    // Moon ki styling JS se
    Object.assign(moon.style, {
        position: 'fixed',
        top: '10%',
        left: '10%',
        width: '70px',
        height: '70px',
        backgroundColor: '#ddd',
        borderRadius: '50%',
        zIndex: '-1',
        boxShadow: 'inset -10px -10px 20px #000, 0 0 15px rgba(255,255,255,0.2)',
        opacity: '0.5'
    });

    // Moon ko body mein attach karna
    document.body.appendChild(moon);
}

// Website load hote hi moon ban jaye
window.addEventListener('DOMContentLoaded', createMoon);



// --- 1. Scroll Animation Logic ---
const initScrollReveal = () => {
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('reveal-visible');
            }
        });
    }, { threshold: 0.0 });

    document.querySelectorAll('.tile').forEach(tile => {
        observer.observe(tile);
    });
};

// --- 3. Modal Open/Close (Option Fix) ---
function openScreen(id) {
    const s = document.getElementById(id);
    if(!s) return;
    s.style.display = 'flex';
    setTimeout(() => s.classList.add('active'), 10);
    
    // Dynamic Content Load
    if(id === 'wpScr') renderWallpapers();
    if(id === 'presetScr') renderPresets();
}

function closeScreen(id) {
    const s = document.getElementById(id);
    if(!s) return;
    s.classList.remove('active');
    setTimeout(() => { s.style.display = 'none'; }, 400);
}

// Initialize on Load
document.addEventListener('DOMContentLoaded', () => {
    initScrollReveal();
    
    // Tiles ko force show karne ke liye agar scroll na ho
    setTimeout(initScrollReveal, 400); 
});
</script><style>.screen {
    /* ... purana code ... */
    overflow-y: auto; /* Modal ke andar ka content scroll hoga */
    overscroll-behavior: contain; /* Scroll end hone par BG ko nahi chedega */
    -webkit-overflow-scrolling: touch;
}

/* Background wrapper ko alag rakho */
#content-wrapper {
    will-change: transform; /* Browser ko optimized rakhta hai */
}
</style><script>function loadCities() {
    const s = document.getElementById('state').value;
    const cSel = document.getElementById('city');
    const cArr = document.getElementById('cityArrow');
    cSel.innerHTML = '<option value="">SELECT CITY</option>';
    
    if(!s || !CONFIG.SERVICE_DB[s]) { 
        cSel.style.display = 'none'; cArr.style.display = 'none'; return; 
    }
    
    cSel.style.display = 'block'; cArr.style.display = 'block';

    const keys = Object.keys(CONFIG.SERVICE_DB[s]);
    
    // Sabhi names nikalna aur duplicates hatana (Delhi_1 -> Delhi)
    const uniqueCities = [...new Set(keys.map(c => c.split('_')[0]))];

    uniqueCities.sort().forEach(c => {
        cSel.innerHTML += `<option value="${c}">${c}</option>`;
    });
}

function showDetails() {
    const s = document.getElementById('state').value;
    const selectedCity = document.getElementById('city').value;
    const scInfo = document.getElementById('scInfo');
    
    if(!selectedCity) { scInfo.innerHTML = ''; return; }

    scInfo.innerHTML = ''; 
    const allKeys = Object.keys(CONFIG.SERVICE_DB[s]);

    // Sabhi keys dhoondna jo selected city se match karein
    const matches = allKeys.filter(key => {
        return key === selectedCity || key.startsWith(selectedCity + "_");
    });

    matches.forEach(key => {
        const d = CONFIG.SERVICE_DB[s][key];
        scInfo.innerHTML += `
        <div class="detail-card" style="margin-bottom:20px;">
            <span class="sc-badge">ID: ${d.c}</span>
            <h3>${d.n}</h3>
            <p style="text-transform:none; opacity:0.8; margin:10px 0;">${d.a}</p>
            <p>TIME: ${d.t} | OFF: ${d.o}</p>
            <div class="card-row">
                <button class="btn" style="width:48%; display:inline-flex; align-items:center; justify-content:center; gap:8px;" onclick="window.open('tel:${d.p}')">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M6.62 10.79a15.05 15.05 0 006.59 6.59l2.2-2.2a1 1 0 011.11-.27c1.12.45 2.33.69 3.58.69a1 1 0 011 1V20a1 1 0 01-1 1A17 17 0 013 4a1 1 0 011-1h3.5a1 1 0 011 1c0 1.25.24 2.46.69 3.58a1 1 0 01-.27 1.11l-2.2 2.2z"/></svg>
                    Call
                </button>
                <button class="btn" style="width:48%; display:inline-flex; align-items:center; justify-content:center; gap:8px;" onclick="window.open('${d.m}')">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 010-5 2.5 2.5 0 010 5z"/></svg>
                   Map 
                </button>
            </div>
        </div>`;
    });
}
        let html = '';
        for (let i = 1; i <= 20; i++) {
            let currentLink = links[i - 1] || "#";
            let currentImg = imageLinks[i - 1];

            html += `
            <div class="wp-card">
                <img src="${currentImg}" alt="Sample ${i}">
                <div class="wp-overlay">
                    <p>PRESET ${i}</p>
                    <button class="btn" onclick="runDownload(this, '${currentLink}')">
                        <div class="progress-bar"></div>
                        <span class="btn-text">GET</span>
                    </button>
                </div>
            </div>`;
        }
        grid.innerHTML = html;
    }

    function runDownload(btn, url) {
        const progressBar = btn.querySelector('.progress-bar');
        const btnText = btn.querySelector('.btn-text');

        btn.style.pointerEvents = "none";
        btnText.innerText = "Loading...";
        progressBar.style.width = "100%";

        setTimeout(() => {
            window.open(url, '_blank'); 
            btnText.innerText = "GET";
            progressBar.style.width = "0%";
            btn.style.pointerEvents = "auto";
        }, 2000);
    }

    // Iske bina code run nahi hoga
    window.onload = renderPresets;
    </script>
</body>
</html><script>window.onload = () => {
        const f = document.getElementById('starField');
        for (let i = 0; i < 300; i++) {
            const s = document.createElement('div'); s.className = 'star';
            s.style.cssText = `width:2px; height:2px; top:${Math.random()*100}%; left:${Math.random()*100}%; animation-delay:${Math.random()*8}s`;
            f.appendChild(s);
        }
    };</script>
<style>.screen {
    /* ... purana code ... */
    overflow-y: auto; /* Modal ke andar ka content scroll hoga */
    overscroll-behavior: contain; /* Scroll end hone par BG ko nahi chedega */
    -webkit-overflow-scrolling: touch;
}

/* Background wrapper ko alag rakho */
#content-wrapper {
    will-change: transform; /* Browser ko optimized rakhta hai */
}


#t-icon {
    transition: transform .3s ease;
}

.t-toggle:active #t-icon {
    transform: rotate(150deg) scale(1.1);
}

</style><style>/* Card ke andar wale button ko chota karne ke liye */
.wp-overlay .btn {
    width: 90%;           /* Pura chauda nahi, thoda chota */
    margin: 0 auto;       /* Center mein rakhne ke liye */
    padding: 8px 0;       /* Oopar niche se space kam ki */
    font-size: 1rem;      /* Text size chota kiya */
    border-radius: 15px;  /* Corners ko thoda kam round kiya */
    min-height: unset;    /* Extra height hatane ke liye */
}

/* Button ke andar ka progress bar bhi chota rahe */
.wp-overlay .btn .progress-bar {
    border-radius: 12px;
}

/* Text alignment center rahe */
.btn-text {
    font-size: 1.1rem !important; 
    letter-spacing: 1px;
}


.screen {
    /* ... purana code ... */
    overflow-y: auto; /* Modal ke andar ka content scroll hoga */
    overscroll-behavior: contain; /* Scroll end hone par BG ko nahi chedega */
    -webkit-overflow-scrolling: touch;
}

/* Background wrapper ko alag rakho */
#content-wrapper {
    will-change: transform; /* Browser ko optimized rakhta hai */
}


.screen {
    /* ... purana code ... */
    overflow-y: auto; /* Modal ke andar ka content scroll hoga */
    overscroll-behavior: contain; /* Scroll end hone par BG ko nahi chedega */
    -webkit-overflow-scrolling: touch;
}

/* Background wrapper ko alag rakho */
#content-wrapper {
    will-change: transform; /* Browser ko optimized rakhta hai */
}



/* AUTO SYSTEM THEME SUPPORT */
:root {
    color-scheme: light dark;
}

@media (prefers-color-scheme: dark) {
    :root {
        --bg: #000;
        --card: #0c0c0c;
        --text: #fff;
        --dot-bg: #250;
        --border: #1a1a1a;
        --instr: #bbb;
    }
}

@media (prefers-color-scheme: light) {
    :root {
        --bg: #fff;
        --card: #f5f5f5;
        --text: #000;
        --dot-bg: #ddd;
        --border: #eee;
        --instr: #333;
    }
}</style><script>function runDownload(btn, typeOrUrl) {
    const bar = btn.querySelector('.progress-bar');
    const txt = btn.querySelector('.btn-text');
    const oldTxt = txt.innerText;

    // Logic to determine the URL
    let url = "#";
    if (typeOrUrl === 'BETA_TOOL') {
        url = CONFIG.BETA_TOOL_URL;
    } else if (typeOrUrl === 'OTA_ZIP') {
        const device = document.getElementById('swSelect').value;
        url = CONFIG.SOFTWARE[device]?.url || "#";
    } else {
        // If it's not a config keyword, treat it as a direct URL
        url = typeOrUrl;
    }

    btn.style.pointerEvents = 'none'; 
    txt.innerText = 'WAITING...';
    bar.style.transition = 'width 2s linear'; 
    bar.style.width = '100%';

    setTimeout(() => {
        if (url !== "#") {
            window.open(url, '_blank');
        } else {
            alert("Download link not found!");
        }
        
        txt.innerText = "DONE ‚úì";
        setTimeout(() => { 
            bar.style.transition = 'none'; 
            bar.style.width = '0%'; 
            txt.innerText = oldTxt; 
            btn.style.pointerEvents = 'all'; 
        }, 1000);
    }, 2000);
}


// Inside your renderPresets function...
html += `
<div class="wp-card">
    <img src="${currentImg}" alt="Sample ${i}">
    <div class="wp-overlay">
        <p>PRESET ${i}</p>
        <button class="btn" onclick="runDownload(this, '${currentLink}')">
            <div class="progress-bar"></div>
            <span class="btn-text">GET</span>
        </button>
    </div>
</div>`;


</script><style>.music-ui { text-align: center; }
.search-box-m { display: flex; background: var(--card); padding: 8px; border-radius: 50px; border: 1px solid var(--border); margin-bottom: 20px; }
.search-box-m input { flex: 1; background: transparent; border: none; outline: none; color: white; padding: 0 15px; font-size: 1.2rem; }
.go-btn { width: 45px; height: 45px; border-radius: 50%; border: none; background: var(--text); color: var(--bg); cursor: pointer; display: flex; align-items: center; justify-content: center; }
#music-card { display: none; margin-top: 20px; background: var(--card); border: 1px solid var(--border); border-radius: 30px; padding: 20px; }
.disc { width: 140px; height: 140px; border-radius: 50%; border: 2px solid var(--border); margin: 0 auto 15px; object-fit: cover; }
.spinning { animation: rotate 10s linear infinite; }
@keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
.m-ctrls { display: flex; justify-content: center; align-items: center; gap: 25px; margin-top: 15px; }
.m-btn { background: none; border: none; color: var(--text); font-size: 1.4rem; cursor: pointer; }

.disc {
    display: block;
    margin: 0 auto 15px auto;  /* üëà ye line MAIN fix hai */
    width: 140px;
    height: 140px;
    border-radius: 50%;
    border: 2px solid var(--border);
    object-fit: cover;
}</style><script>/* ===============================
   MUSIC PLAYER ‚Äì FINAL VERSION
   =============================== */

let songQueue = [];
let curIdx = 0;

const player = document.getElementById('mPlayer');
const mini = document.getElementById('mini-player');
const miniArt = document.getElementById('mini-art');
const mainArt = document.getElementById('mArt');

/* ---------- SAFE INIT ---------- */
window.onload = () => {
    mini.style.display = "none";
    mainArt.classList.remove('spinning');
    miniArt.classList.remove('spinning');
};

/* ---------- SEARCH MUSIC ---------- */
async function searchMusic() {
    const q = document.getElementById('mQuery').value;
    if (!q) return;

    try {
        const res = await fetch(
            `https://itunes.apple.com/search?term=${encodeURIComponent(q)}&limit=500&entity=song`
        );
        const data = await res.json();

        if (data.results.length > 0) {
            songQueue = data.results;
            curIdx = 0;
            loadSong(curIdx);
            document.getElementById('music-card').style.display = "block";
        }
    } catch (e) {
        console.log("Search Error", e);
    }
}

/* ---------- LOAD SONG ---------- */
function loadSong(idx) {
    const t = songQueue[idx];

    document.getElementById('mTitle').innerText = t.trackName.toUpperCase();
    document.getElementById('mArtist').innerText = t.artistName.toUpperCase();

    const img = t.artworkUrl100.replace('100x100', '500x500');
    mainArt.src = img;
    miniArt.src = img;

    player.src = t.previewUrl;
    player.play(); // audio events handle everything
}

/* ---------- AUDIO EVENTS (MASTER) ---------- */
player.addEventListener("play", () => {
    mini.style.display = "block";
    mainArt.classList.add('spinning');
    miniArt.classList.add('spinning');
});

player.addEventListener("pause", () => {
    mainArt.classList.remove('spinning');
    miniArt.classList.remove('spinning');
});

player.addEventListener("ended", () => {
    mini.style.display = "none";
    mainArt.classList.remove('spinning');
    miniArt.classList.remove('spinning');
});

/* ---------- CONTROLS ---------- */
function togglePlay() {
    const icon = document.querySelector('#play-pause i');

    if (player.paused) {
        player.play();
        icon.className = "fa-solid fa-circle-pause";
    } else {
        player.pause();
        icon.className = "fa-solid fa-circle-play";
    }
}

function nextSong() {
    if (curIdx < songQueue.length - 1) {
        curIdx++;
        loadSong(curIdx);
    }
}

function prevSong() {
    if (curIdx > 0) {
        curIdx--;
        loadSong(curIdx);
    }
}

/* ---------- UI ACTIONS ---------- */
function handleMusicClose() {
    closeScreen('musicScr'); // mini state handled by audio
}

function restorePlayer() {
    openScreen('musicScr');
}

/* ---------- DOWNLOAD ---------- */
function downloadCurrentSong() {
    const a = document.createElement('a');
    a.href = player.src;
    a.download = document.getElementById('mTitle').innerText + ".mp3";
    a.click();
}</script>



<style>/* ================= ROOT VARIABLES ================= */
:root { 
    --bg: #000; 
    --card: #0c0c0c; 
    --text: #fff; 
    --dot-bg: rgba(255, 255, 255, 0.1);
    --border: #1a1a1a; 
    --accent: #ff0000;
    --transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Light Theme */
[data-theme="light"] { 
    --bg: #fff; 
    --card: #f5f5f5; 
    --text: #000; 
    --dot-bg: #ddd; 
    --border: #eee; 
}

/* ================= BASE ================= */
body { 
    background: var(--bg); 
    color: var(--text); 
    transition: all var(--transition);
}

/* ================= ENTRANCE LOADER ================= */
.entrance-wrapper {
    position: fixed;
    inset: 0;
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
    transition: transform 1.8s cubic-bezier(0.77, 0, 0.175, 1);
}

.entrance-wrapper.exit {
    transform: translateY(-100%);
}

.nothing-logo {
    font-family: 'NDOT', sans-serif;
    color: #fff;
    letter-spacing: 5px;
    font-size: 2rem;
    animation: pulse 1.5s infinite;
}

/* ================= LOADER BAR ================= */
.loader-bar {
    width: 225px;
    height: 2px;
    background: #333;
    margin-top: 10px;
    position: relative;
    overflow: hidden;
}

.loader-bar::after {
    content: '';
    position: absolute;
    width: 60px;
    height: 100%;
    background: #fff;
    animation: loading 10.5s infinite;
}

/* ================= DOT LOADER ================= */
.dot-loader {
    display: flex;
    gap: 4px;
    justify-content: center;
    align-items: center;
    height: 24px;
}

.dot-loader span {
    width: 6px;
    height: 6px;
    background: var(--bg);
    border-radius: 50%;
    animation: bounce 0.4s infinite alternate;
}

.dot-loader span:nth-child(2) { animation-delay: 0.1s; }
.dot-loader span:nth-child(3) { animation-delay: 0.2s; }

/* ================= STARS ================= */
.star {
    position: absolute;
    background: #fff;
    border-radius: 50%;
    pointer-events: none;
    z-index: -2;
}

/* ================= GUIDE TEXT ================= */
.guide-content p {
    color: var(--text) !important;
    opacity: 0.7 !important;
    font-size: 1.1rem;
    line-height: 1.2;
    padding: 10px 0;
    text-align: left;
}

/* ================= ANIMATIONS ================= */
@keyframes loading {
    from { left: -50px; }
    to { left: 100px; }
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
}

@keyframes bounce {
    from { transform: translateY(4px); }
    to { transform: translateY(-4px); }
}</style><script>let SERVICE_DB = {}; // Global variable

async function initServiceData() {
    // Hamesha 'main' branch wala URL use karein latest data ke liye
    const url = "https://raw.githubusercontent.com/nothingcommunity/Testing/main/Service%20Centre/service_centre.json";
    
    try {
        const response = await fetch(url);
        if (!response.ok) throw new Error("Network Response Fail");
        
        SERVICE_DB = await response.json();
        console.log("Service data loaded ‚úÖ", SERVICE_DB);
        
    } catch (err) {
        console.error("Fetch Error ‚ùå:", err);
    }
}

function loadCities() {
    const s = document.getElementById('state').value;
    const cSel = document.getElementById('city');
    const cArr = document.getElementById('cityArrow');
    
    cSel.innerHTML = '<option value="">SELECT CITY</option>';
    
    // Yahan fix hai: CONFIG.SERVICE_DB ki jagah sirf SERVICE_DB
    if(!s || !SERVICE_DB[s]) { 
        cSel.style.display = 'none'; 
        cArr.style.display = 'none'; 
        return; 
    }
    
    cSel.style.display = 'block'; 
    cArr.style.display = 'block';

    const keys = Object.keys(SERVICE_DB[s]);
    
    // "Delhi_1", "Delhi_2" ko clean karke sirf "Delhi" nikalne ke liye
    const uniqueCities = [...new Set(keys.map(c => c.split('_')[0]))];

    uniqueCities.sort().forEach(c => {
        cSel.innerHTML += `<option value="${c}">${c}</option>`;
    });
}

function showDetails() {
    const s = document.getElementById('state').value;
    const selectedCity = document.getElementById('city').value;
    const scInfo = document.getElementById('scInfo');
    
    if(!selectedCity || !SERVICE_DB[s]) { 
        scInfo.innerHTML = ''; 
        return; 
    }

    scInfo.innerHTML = ''; 
    const allKeys = Object.keys(SERVICE_DB[s]);

    // Match "Delhi" with "Delhi_1", "Delhi_2" etc.
    const matches = allKeys.filter(key => {
        return key === selectedCity || key.startsWith(selectedCity + "_");
    });

    matches.forEach(key => {
        const d = SERVICE_DB[s][key];
        scInfo.innerHTML += `
        <div class="detail-card" style="margin-bottom:20px; border: 1px solid var(--border); padding: 20px; border-radius: 20px;">
            <div style="display:flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px;">
                <h3 style="font-size: 1.4rem; color: var(--text);">${d.n}</h3>
                <span class="sc-badge" style="background: #222; padding: 4px 8px; border-radius: 5px; font-size: 0.8rem;">ID: ${d.c}</span>
            </div>
            <p style="text-transform:none; opacity:0.7; font-size: 1rem; margin-bottom: 15px;">${d.a}</p>
            <div style="font-size: 0.9rem; margin-bottom: 15px;">
                <p>üïí ${d.t}</p>
                <p>üö´ OFF: ${d.o}</p>
            </div>
            <div class="card-row" style="display: flex; gap: 10px;">
                <button class="btn" style="flex:1; padding: 12px;" onclick="window.open('tel:${d.p}')">CALL</button>
                <button class="btn" style="flex:1; padding: 12px;" onclick="window.open('${d.m}')">MAPS</button>
            </div>
        </div>`;
    });
}

// Page load hone par function call
window.addEventListener('DOMContentLoaded', initServiceData);


window.addEventListener('load', () => {
    const wrapper = document.getElementById('wrapper');
    
    // 2 second tak wrapper dikhao, phir hata do
    setTimeout(() => {
        if(wrapper) {
            wrapper.classList.add('exit');
            // Permanently remove karne ke liye
            setTimeout(() => { wrapper.style.display = 'none'; }, 1300);
        }
    }, 2000); 
});


async function searchMusic() {
    const q = document.getElementById('mQuery').value;
    const btn = document.querySelector('.go-btn');
    
    if(!q) return;

    // Button ke andar bouncing dots daalna
    const originalContent = btn.innerHTML;
    btn.innerHTML = `<div class="dot-loader"><span></span><span></span><span></span></div>`;
    btn.disabled = true;

    try {
        const res = await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(q)}&limit=500&entity=song`);
        const data = await res.json();
        
        if(data.results.length > 0) {
            songQueue = data.results; 
            curIdx = 0;
            loadSong(curIdx);
            document.getElementById('music-card').style.display = "block";
        }
    } catch(e) { 
        console.log(e); 
    } finally {
        // Wapas Magnifying Glass icon le aana
        btn.innerHTML = originalContent;
        btn.disabled = false;
    }
}
// Jab gaana load ho tab icon ko Pause dikhana chahiye (kyuki gaana baj raha hai)
function loadSong(idx) {
    const t = songQueue[idx];
    document.getElementById('mTitle').innerText = t.trackName.toUpperCase();
    document.getElementById('mArtist').innerText = t.artistName.toUpperCase();
    const img = t.artworkUrl100.replace('100x100', '500x500');
    document.getElementById('mArt').src = img;
    document.getElementById('mini-art').src = img;
    
    player.src = t.previewUrl;
    player.play();

    // UI Reset
    const icon = document.querySelector('#play-pause i');
    icon.className = "fa-solid fa-circle-pause"; // Playing state
    document.getElementById('mArt').classList.add('spinning');
    document.getElementById('mini-art').classList.add('spinning');
    mini.style.display = "none";
}

function togglePlay() {
    const icon = document.querySelector('#play-pause i');
    if (player.paused) {
        player.play();
        icon.className = "fa-solid fa-circle-pause";
        document.getElementById('mArt').classList.add('spinning');
        document.getElementById('mini-art').classList.add('spinning');
    } else {
        player.pause();
        icon.className = "fa-solid fa-circle-play";
        document.getElementById('mArt').classList.remove('spinning');
        document.getElementById('mini-art').classList.remove('spinning');
    }
}

function createStars() {
    const field = document.getElementById('starField');
    if(!field) return;
    field.innerHTML = ''; // Purane stars clear karne ke liye
    for(let i=0; i<250; i++) {
        const s = document.createElement('div');
        s.className = 'star';
        const size = Math.random() * 3;
        s.style.width = size + 'px';
        s.style.height = size + 'px';
        s.style.top = Math.random() * 100 + '%';
        s.style.left = Math.random() * 100 + '%';
        s.style.animation = `blink ${2 + Math.random() * 3}s infinite`;
        s.style.opacity = Math.random();
        field.appendChild(s);
    }
}
// Isko window.onload ke andar call karein
window.addEventListener('load', createStars);

// 1. System Theme Detect karne ke liye function
function applyAutoTheme() {
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const root = document.documentElement;
    
    if (prefersDark) {
        root.setAttribute('data-theme', 'dark');
        updateThemeIcon('dark');
    } else {
        root.setAttribute('data-theme', 'light');
        updateThemeIcon('light');
    }
}

// 2. Manual Toggle Button Fix
function toggleTheme() {
    const root = document.documentElement;
    const currentTheme = root.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
    
    root.setAttribute('data-theme', newTheme);
    updateThemeIcon(newTheme);
}

// 3. Icon update karne ke liye (Moon/Sun)
function updateThemeIcon(theme) {
    const icon = document.querySelector('.t-toggle i');
    if (theme === 'dark') {
        icon.className = "fa-solid fa-circle";
    } else {
        icon.className = "fa-solid fa-sun";
    }
}

// Window load hote hi auto-theme check karein
window.addEventListener('load', () => {
    applyAutoTheme();
    createStars(); // Aapka star function
});
function downloadCurrentSong() {
    const btn = document.querySelector('.btn');
    const originalContent = btn.innerHTML; // Purana text aur icon save kiya

    // 1. Button ke andar dots daalna (1 second ke liye)
    btn.innerHTML = `<div class="dot-loader"><span></span><span></span><span></span></div>`;
    btn.style.pointerEvents = 'none'; // Double click rokne ke liye

    // 2. Actual Download Logic
    const a = document.createElement('a'); 
    a.href = player.src;
    a.download = document.getElementById('mTitle').innerText + ".mp3";
    a.click();

    // 3. 1 second baad wapas normal karna
    setTimeout(() => {
        btn.innerHTML = originalContent;
        btn.style.pointerEvents = 'auto';
    }, 1000);
}
function runDownload(btn, input) {
    const bar = btn.querySelector('.progress-bar');
    const txt = btn.querySelector('.btn-text');
    const oldTxt = txt.innerText;

    let finalUrl = "#";

    // 1. Check if it's a keyword or a direct link
    if (input === 'BETA_TOOL') {
        finalUrl = CONFIG.BETA_TOOL_URL;
    } else if (input === 'OTA_ZIP') {
        const device = document.getElementById('swSelect').value;
        if(!device) { alert("PLEASE SELECT A DEVICE FIRST!"); return; }
        finalUrl = CONFIG.SOFTWARE[device]?.url || "#";
    } else {
        // Agar keyword nahi hai, toh matlab wallpaper ka direct link hai
        finalUrl = input;
    }

    if (finalUrl === "#" || !finalUrl) {
        alert("DOWNLOAD LINK NOT FOUND!");
        return;
    }

    // 2. Animation Logic
    btn.style.pointerEvents = 'none'; 
    txt.innerText = 'WAITING...';
    bar.style.transition = 'width 1.5s linear'; 
    bar.style.width = '100%';

    setTimeout(() => {
        // 3. Trigger Download
        const link = document.createElement('a');
        link.href = finalUrl;
        link.target = "_blank";
        link.download = "Download_File"; 
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        txt.innerText = "DONE ‚úì";
        setTimeout(() => { 
            bar.style.transition = 'none'; 
            bar.style.width = '0%'; 
            txt.innerText = oldTxt; 
            btn.style.pointerEvents = 'all'; 
        }, 1000);
    }, 1500);
}
function renderWallpapers() {
    const grid = document.getElementById('wallpaperGrid');
    grid.innerHTML = CONFIG.WALLPAPERS.map((w, i) => `
        <div class="wp-card">
            <img src="${w.img}">
            <div class="wp-overlay">
                <button class="btn" style="padding:12px;" onclick="runDownload(this, '${w.url}')">
                    <div class="progress-bar"></div>
                    <span class="btn-text">DOWNLOAD</span>
                </button>
            </div>
        </div>`).join('');
}

async function initWallpaperData() {
    const url = "https://raw.githubusercontent.com/nothingcommunity/Testing/main/Wallpapers/Walls/wallpapers.json";
    const grid = document.getElementById('wallpaperGrid');
    
    try {
        const response = await fetch(url, { cache: "no-cache" });
        if (!response.ok) throw new Error("Network response was not ok");
        
        const data = await response.json();
        
        // Handling both cases: if JSON is a direct array or an object containing an array
        CONFIG.WALLPAPERS = Array.isArray(data) ? data : data.wallpapers;
        
        if (CONFIG.WALLPAPERS && CONFIG.WALLPAPERS.length > 0) {
            renderWallpapers();
        } else {
            grid.innerHTML = "<p style='padding:20px; opacity:0.5;'>NO WALLPAPERS FOUND IN JSON</p>";
        }
    } catch (err) {
        console.error("Fetch Error:", err);
        grid.innerHTML = "<p style='padding:20px; color:red;'>FETCH ERROR: CHECK CONSOLE</p>";
    }
}

// Updated OpenScreen to handle the loading state
async function openScreen(id) { 
    const s = document.getElementById(id); 
    if(!s) return;

    s.style.display = 'flex'; 
    setTimeout(() => s.classList.add('active'), 10);

    if(id === 'wpScr') {
        const grid = document.getElementById('wallpaperGrid');
        grid.innerHTML = "<p class='loading-text' style='padding:20px; opacity:0.5;'>LOADING WALLPAPERS...</p>";
        await initWallpaperData();
    }
}
async function runDownload(btn, url) {
    const bar = btn.querySelector('.progress-bar');
    const txt = btn.querySelector('.btn-text');
    const oldTxt = txt.innerText;

    if (!url || url === "#") {
        alert("LINK NOT FOUND!");
        return;
    }

    btn.style.pointerEvents = 'none'; 
    txt.innerText = 'FETCHING...';
    bar.style.transition = 'width 2s linear'; 
    bar.style.width = '100%';

    try {
        // Image fetch karke blob banana (CORS proxy agar zaroorat ho)
        const response = await fetch(url);
        const blob = await response.blob();
        const blobUrl = window.URL.createObjectURL(blob);
        
        // Hidden anchor tag se download trigger karna
        const link = document.createElement('a');
        link.href = blobUrl;
        link.download = "NothingZones_Preset_" + Date.now() + ".png"; 
        document.body.appendChild(link);
        link.click();
        
        // Clean up
        document.body.removeChild(link);
        window.URL.revokeObjectURL(blobUrl);

        txt.innerText = "DONE ‚úì";
    } catch (err) {
        console.error("Download Error:", err);
        // Fallback: Agar fetch fail ho toh purana method (preview)
        window.open(url, '_blank');
        txt.innerText = "OPENED";
    }

    setTimeout(() => { 
        bar.style.transition = 'none'; 
        bar.style.width = '0%'; 
        txt.innerText = oldTxt; 
        btn.style.pointerEvents = 'all'; 
    }, 1500);
}
async function runDownload(btn, input) {
    const bar = btn.querySelector('.progress-bar');
    const txt = btn.querySelector('.btn-text');
    const oldTxt = txt.innerText;

    let finalUrl = "";

    // 1. URL Identify Karein
    if (input === 'BETA_TOOL') {
        finalUrl = CONFIG.BETA_TOOL_URL;
    } else if (input === 'OTA_ZIP') {
        const device = document.getElementById('swSelect').value;
        if(!device) { alert("PLEASE SELECT A DEVICE!"); return; }
        finalUrl = CONFIG.SOFTWARE[device]?.url;
    } else {
        finalUrl = input; // Wallpaper ya preset link
    }

    if (!finalUrl) { alert("LINK NOT FOUND!"); return; }

    // Animation Start
    btn.style.pointerEvents = 'none';
    txt.innerText = 'PROCESSING...';
    bar.style.transition = 'width 1.5s linear';
    bar.style.width = '100%';

    // 2. File Type Check Karein
    const isZip = finalUrl.toLowerCase().endsWith('.zip') || finalUrl.toLowerCase().endsWith('.apk');

    if (isZip) {
        // ZIP/APK ke liye direct download (Kyunki Blob memory limit cross kar deta hai)
        setTimeout(() => {
            const link = document.createElement('a');
            link.href = finalUrl;
            link.target = "_blank"; // New tab mein open karega taaki page refresh na ho
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            finishDownload(btn, txt, bar, oldTxt);
        }, 1000);
    } else {
        // Images ke liye Force Download (Blob Method)
        try {
            const response = await fetch(finalUrl);
            const blob = await response.blob();
            const blobUrl = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = blobUrl;
            link.download = "NothingZones_" + Date.now() + ".png";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            window.URL.revokeObjectURL(blobUrl);
            finishDownload(btn, txt, bar, oldTxt);
        } catch (err) {
            // Fallback: Agar fetch block ho toh direct open karein
            window.open(finalUrl, '_blank');
            finishDownload(btn, txt, bar, oldTxt);
        }
    }
}

function finishDownload(btn, txt, bar, oldTxt) {
    txt.innerText = "DONE ‚úì";
    setTimeout(() => {
        bar.style.transition = 'none';
        bar.style.width = '0%';
        txt.innerText = oldTxt;
        btn.style.pointerEvents = 'all';
    }, 1000);
}
async function initPresetData() {
    // 1. Grid element ko target karein
    const grid = document.getElementById('presetGrid');
    if (!grid) {
        console.error("ID 'presetGrid' not found in HTML!");
        return;
    }

    // 2. GitHub Raw Link
    const url = "https://raw.githubusercontent.com/nothingcommunity/Testing/main/Camera%20Presets/Presets/presets.json";

    try {
        const response = await fetch(url, { cache: "no-cache" });
        if (!response.ok) throw new Error("Fetch failed");

        const data = await response.json();

        // 3. Render logic
        if (Array.isArray(data) && data.length > 0) {
            grid.innerHTML = data.map(p => `
                <div class="wp-card">
                    <img src="${p.img}" loading="lazy" onerror="this.src='https://via.placeholder.com/150'">
                    <div class="wp-overlay">
                        <p>${p.id || 'PRESET'}</p>
                        <button class="btn" onclick="runDownload(this, '${p.url}')">
                            <div class="progress-bar"></div>
                            <span class="btn-text">GET</span>
                        </button>
                    </div>
                </div>
            `).join('');
        } else {
            grid.innerHTML = "<p style='padding:20px;'>NO DATA FOUND</p>";
        }
    } catch (err) {
        console.error("Error:", err);
        grid.innerHTML = "<p style='padding:20px; color:red;'>FETCH ERROR</p>";
    } finally {
        // Loading text ko hide karein
        const loader = document.querySelector('#presetScr .loading-text');
        if (loader) loader.style.display = 'none';
    }
}
function openScreen(id) {
    const s = document.getElementById(id);
    if(!s) return;

    s.style.display = 'flex';
    setTimeout(() => s.classList.add('active'), 10);

    // Agar Preset screen hai toh fetch start karein
    if(id === 'presetScr') {
        initPresetData(); 
    }
}
function openScreen(id) {
    const s = document.getElementById(id);
    if(!s) return;

    s.style.display = 'flex';
    setTimeout(() => s.classList.add('active'), 10);

    // Wallpaper screen ke liye
    if(id === 'wpScr') {
        initWallpaperData(); 
    }
    
    // Preset screen ke liye
    if(id === 'presetScr') {
        initPresetData();
    }
}
</script><style>/* Search Box Container */
.search-box-m {
    display: flex;
    background: #eef2f7 !important; /* Light background */
    border-radius: 50px !important;
    padding: 5px 10px;
    align-items: center;
    border: 1px solid var(--border);
}

/* Input Text Color Fix */
#mQuery {
    flex: 1;
    background: transparent !important;
    border: none !important;
    color: #000 !important; /* Text ab kaala dikhega */
    padding: 12px;
    font-size: 1.2rem;
    outline: none;
}

/* Gol Search Button */
.go-btn {
    width: 40px !important;
    height: 40px !important;
    border-radius: 50% !important; /* Perfect Round */
    background: #000 !important;
    color: #fff !important;
    border: none;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
}

/* Mini Player Image Fix */
#mini-art {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block; /* Ensure visibility */
}
/* Preset Overlay ke andar ka text hamesha white rahega */
.wp-overlay p {
    color: #ffffff !important;
    opacity: 1 !important;
    font-weight: bold;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.5); /* Visibility ke liye shadow */
}

/* Preset button ka text color fix */
.wp-overlay .btn-text {
    color: #000000 !important; /* Button background white hota hai, isliye text black/dark */
}

/* Heading Fix (Jo aapne red box mein mark kiya tha) */
.up-box h4 {
    color: var(--text) !important;
}
/* Get button ka text hamesha black rahega taaki white background pe dikhe */
.wp-overlay .btn .btn-text {
    color: #000000 !important; 
    font-weight: bold !important;
    opacity: 1 !important;
}

/* Button hover/active state fix */
.wp-overlay .btn {
    background: #ffffff !important;
}
/* Unique User Badge */
.u-badge {
    font-size: 0.7rem;
    background: var(--text);
    color: var(--bg);
    padding: 2px 8px;
    border-radius: 5px;
    margin-bottom: 5px;
    display: inline-block;
}

/* Chat Bubble */
.msg-bubble {
    background: rgba(255,255,255,0.03);
    border: 1px solid var(--border);
    padding: 12px 15px;
    border-radius: 20px;
    position: relative;
    max-width: 85%;
    align-self: flex-start;
    animation: slideIn 0.3s ease;
}

/* Admin Reply Glassmorphism */
.admin-reply-box {
    margin-top: 10px;
    padding: 8px 12px;
    background: rgba(255, 0, 0, 0.05);
    border-left: 2px solid var(--accent);
    border-radius: 10px;
    font-size: 0.9rem;
}

.admin-tag {
    color: var(--accent);
    font-weight: bold;
    font-size: 0.7rem;
    display: block;
    margin-bottom: 2px;
}

@keyframes slideIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}
/* Input container setup */
.input-container {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 30px;
    padding: 5px 5px 5px 15px;
    display: flex;
    align-items: center;
    justify-content: space-between; /* Isse button right mein chala jayega */
    margin-top: 15px;
}

/* Send Button Style */
.send-btn {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    background: var(--text);
    color: var(--bg);
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0; /* Button dabe nahi */
}
.modal {
    position: relative; /* zaroori hai */
}

.close-icon {
    position: absolute;
    top: 35px;
    right: 20px;
    cursor: pointer;
    font-size: 35px;
}</style><script>let currentPlaylist = [];
let currentIndex = 0;
let lastPlayedArt = "";

async function searchMusic() {
    const query = document.getElementById('mQuery').value;
    const btn = document.getElementById('mSearchBtn') || document.querySelector('.go-btn');
    const card = document.getElementById('music-card');
    
    if (!query) return;

    btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i>';

    try {
        const res = await fetch(`https://itunes.apple.com/search?limit=250&entity=song&term=${encodeURIComponent(query)}`);
        const data = await res.json();

        if (data.results.length > 0) {
            currentPlaylist = data.results.map(song => {
                // FIX: Title se mzaf_ ko hamesha ke liye saaf karna
                const cleanTitle = song.trackName.replace(/mzaf_\d+/g, "NOTHING TRACK").toUpperCase();
                return {
                    url: song.previewUrl,
                    art: song.artworkUrl100.replace('100x100', '400x400'),
                    title: cleanTitle,
                    artist: "NOTHING ZONES"
                };
            });
            
            currentIndex = 0;
            btn.innerHTML = '<i class="fa-solid fa-magnifying-glass"></i>';
            card.style.display = "block"; 
            loadSong(0);
        } else {
            alert("NOTHING FOUND");
            btn.innerHTML = '<i class="fa-solid fa-magnifying-glass"></i>';
        }
    } catch (e) {
        btn.innerHTML = '<i class="fa-solid fa-magnifying-glass"></i>';
    }
}

function loadSong(index) {
    if (!currentPlaylist[index]) return;
    
    const song = currentPlaylist[index];
    const player = document.getElementById('mPlayer');
    
    // UI Update
    document.getElementById('mArt').src = song.art;
    document.getElementById('mTitle').innerText = song.title;
    document.getElementById('mArtist').innerText = song.artist;
    
    // Small Icon (Mini Player) ke liye image update
    lastPlayedArt = song.art;
    const miniArt = document.getElementById('mini-art');
    if(miniArt) miniArt.src = lastPlayedArt; 
    
    player.src = song.url;
    player.load();
    togglePlay(true);
}

function nextSong() {
    if (currentPlaylist.length > 0) {
        currentIndex = (currentIndex + 1) % currentPlaylist.length;
        loadSong(currentIndex);
    }
}

function prevSong() {
    if (currentPlaylist.length > 0) {
        currentIndex = (currentIndex - 1 + currentPlaylist.length) % currentPlaylist.length;
        loadSong(currentIndex);
    }
}

function togglePlay(forcePlay = false) {
    const player = document.getElementById('mPlayer');
    const playBtn = document.getElementById('play-pause');
    const icon = playBtn ? playBtn.querySelector('i') : null;
    
    if (player.paused || forcePlay) {
        player.play().catch(() => {});
        if(icon) icon.className = "fa-solid fa-circle-pause";
        document.getElementById('mArt').classList.add('spinning');
    } else {
        player.pause();
        if(icon) icon.className = "fa-solid fa-circle-play";
        document.getElementById('mArt').classList.remove('spinning');
    }
}

// DOWNLOAD FIX: No mzaf, only NOTHING ZONES
async function downloadCurrentSong() {
    const song = currentPlaylist[currentIndex];
    const btn = document.querySelector('#music-card .btn');
    const originalText = btn.innerText;

    try {
        btn.innerText = "PREPARING...";
        const response = await fetch(song.url);
        const blob = await response.blob();
        const url = window.URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        // Pura saaf naam NOTHING ZONESke sath
        a.download = song.title.replace(/\s+/g, '_') + "_NOTHING_ZONES.mp3"; 
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        
        btn.innerText = "DONE ‚úì";
        setTimeout(() => { btn.innerText = "DOWNLOAD MP3"; }, 2000);
    } catch (e) {
        window.open(song.url, '_blank');
        btn.innerText = originalText;
    }
}

function handleMusicClose() {
    closeScreen('musicScr');
    const player = document.getElementById('mPlayer');
    const miniPlayer = document.getElementById('mini-player');
    const miniArt = document.getElementById('mini-art');

    if (!player.paused) {
        miniPlayer.style.display = 'block';
        miniArt.src = lastPlayedArt; // Modal band hote hi small icon mein pic
    }
}

function loadSong(index) {
    if (!currentPlaylist[index]) return;
    
    const song = currentPlaylist[index];
    const player = document.getElementById('mPlayer');
    
    // UI Update (Modal picture)
    document.getElementById('mArt').src = song.art;
    document.getElementById('mTitle').innerText = song.title;
    document.getElementById('mArtist').innerText = song.artist;
    
    // Mini Player update
    lastPlayedArt = song.art;
    const miniArt = document.getElementById('mini-art');
    if(miniArt) miniArt.src = lastPlayedArt; 
    
    // Audio source update
    player.src = song.url;
    player.load();
    togglePlay(true);

    // FIX: Notification Bar (Android Media Panel) mein image bhejnat
    if ('mediaSession' in navigator) {
        navigator.mediaSession.metadata = new MediaMetadata({
            title: song.title,
            artist: 'NOTHING ZONES',
            album: 'NOTHING ZONES',
            artwork: [
                { src: song.art, sizes: '96x96',   type: 'image/png' },
                { src: song.art, sizes: '128x128', type: 'image/png' },
                { src: song.art, sizes: '192x192', type: 'image/png' },
                { src: song.art, sizes: '256x256', type: 'image/png' },
                { src: song.art, sizes: '384x384', type: 'image/png' },
                { src: song.art, sizes: '512x512', type: 'image/png' },
            ]
        });

        // Notification bar ke buttons (Next/Prev) ko connect karna
        navigator.mediaSession.setActionHandler('previoustrack', prevSong);
        navigator.mediaSession.setActionHandler('nexttrack', nextSong);
        navigator.mediaSession.setActionHandler('play', () => togglePlay(true));
        navigator.mediaSession.setActionHandler('pause', () => togglePlay());
    }
}

// Sample Data (Real life mein ye database se aayega)
let messages = [
    { id: 1, userNum: 1, text: "Bhai Phone 2a ke liye naye presets lao!", reply: "" },
    { id: 2, userNum: 2, text: "Website ka UI aag hai üî•", reply: "Thanks for the support!" }
];

function renderBoard() {
    const board = document.getElementById('msgBoard');
    board.innerHTML = messages.map(m => `
        <div class="msg-bubble" onclick="adminReply(${m.id})">
            <span class="u-badge">USER #${m.userNum}</span>
            <p style="text-transform: none; color: var(--text); line-height: 1.3;">${m.text}</p>
            ${m.reply ? `
                <div class="admin-reply-box">
                    <span class="admin-tag">‚óè ADMIN REPLY</span>
                    <p style="text-transform: none; opacity: 0.8;">${m.reply}</p>
                </div>
            ` : ''}
        </div>
    `).join('');
    board.scrollTop = board.scrollHeight;
}

function sendMsg() {
    const input = document.getElementById('userMsg');
    if(!input.value.trim()) return;

    // Har naye msg ko agla number dena
    const nextUserNum = messages.length + 1;

    messages.push({
        id: Date.now(),
        userNum: nextUserNum,
        text: input.value,
        reply: ""
    });

    input.value = "";
    renderBoard();
}

function adminReply(msgId) {
    // Admin password check
    const pass = prompt("ADMIN ACCESS REQUIRED:");
    if(pass === "465610") { 
        const msg = messages.find(m => m.id === msgId);
        const replyTxt = prompt(`REPLY TO USER #${msg.userNum}:`);
        if(replyTxt) {
            msg.reply = replyTxt;
            renderBoard();
        }
    }
}

// Initial Call
document.addEventListener('DOMContentLoaded', renderBoard);
function adminReply(msgId) {
    const pass = prompt("ADMIN ACCESS REQUIRED:");
    
    if (pass === "465610") { // Aapka Password
        const action = prompt("CHOOSE ACTION: \n1. REPLY \n2. DELETE MESSAGE \n3. DELETE ONLY REPLY");
        const msg = messages.find(m => m.id === msgId);

        if (!msg) return;

        if (action === "1") {
            const replyTxt = prompt(`REPLY TO USER #${msg.userNum}:`);
            if (replyTxt) msg.reply = replyTxt;
        } 
        else if (action === "2") {
            const confirmDel = confirm("DELETE THIS ENTIRE MESSAGE?");
            if (confirmDel) {
                messages = messages.filter(m => m.id !== msgId);
            }
        } 
        else if (action === "3") {
            msg.reply = ""; // Sirf admin ka reply hatega
        }
        
        renderBoard(); // Board refresh karein
    } else {
        alert("WRONG PASSWORD!");
    }
}
// 1. Aapka Firebase Database URL
const DB_URL = "https://nothingcommunity-7664f-default-rtdb.firebaseio.com/chat.json";

// 2. Database se messages load karke screen par dikhana
async function loadMessages() {
    try {
        const res = await fetch(DB_URL);
        const data = await res.json();
        const board = document.getElementById('msgBoard');
        
        if (!data) {
            board.innerHTML = '<p style="opacity:0.4; text-align:center; font-family:var(--nothing-font);">NO MESSAGES YET. BE THE FIRST!</p>';
            return;
        }

        // Firebase data (Object) ko Array mein badalna
        const messages = Object.keys(data).map(key => ({ id: key, ...data[key] }));

        board.innerHTML = messages.map(m => `
            <div class="msg-bubble" onclick="adminControl('${m.id}', ${m.userNum})">
                <span class="u-badge">USER #${m.userNum}</span>
                <p style="text-transform:none; margin:5px 0;">${m.text}</p>
                ${m.reply ? `
                    <div class="admin-reply-box">
                        <span class="admin-tag">‚óè ADMIN REPLY</span>
                        <p style="text-transform:none; opacity:0.8;">${m.reply}</p>
                    </div>
                ` : ''}
            </div>
        `).join('');
        
        // Auto scroll to bottom
        board.scrollTop = board.scrollHeight;
    } catch (error) {
        console.error("Error loading chat:", error);
    }
}

// 3. Naya message bhejte hi Firebase mein save karna
async function sendMsg() {
    const input = document.getElementById('userMsg');
    const msgText = input.value.trim();
    if(!msgText) return;

    // User Number calculate karne ke liye current count check karein
    const res = await fetch(DB_URL);
    const data = await res.json();
    const nextNum = data ? Object.keys(data).length + 1 : 1;

    const newEntry = {
        userNum: nextNum,
        text: msgText,
        reply: "",
        timestamp: Date.now()
    };

    // Firebase API call (POST se naya message add hota hai)
    await fetch(DB_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(newEntry)
    });

    input.value = "";
    loadMessages(); // Refresh chat
}

// 4. Admin Control: Reply or Delete
async function adminControl(msgId, userNum) {
    const pass = prompt("ADMIN PASSWORD:");
    if (pass === "465610") { // Apna password change kar sakte ho
        const action = prompt("WHAT TO DO? \n1. REPLY \n2. DELETE MESSAGE \n3. REMOVE ONLY REPLY");
        const itemUrl = `https://nothingcommunity-7664f-default-rtdb.firebaseio.com/chat/${msgId}.json`;

        if (action === "1") {
            const txt = prompt(`REPLY TO USER #${userNum}:`);
            if(txt) await fetch(itemUrl, { method: 'PATCH', body: JSON.stringify({ reply: txt }) });
        } 
        else if (action === "2") {
            if(confirm("Bhai, user ka message hamesha ke liye delete karein?")) {
                await fetch(itemUrl, { method: 'DELETE' });
            }
        } 
        else if (action === "3") {
            await fetch(itemUrl, { method: 'PATCH', body: JSON.stringify({ reply: "" }) });
        }
        loadMessages();
    } else if (pass !== null) {
        alert("WRONG PASSWORD!");
    }
}

// Website khulte hi chat load karein
document.addEventListener('DOMContentLoaded', loadMessages);
</script><style>/* Red Dot Pulse Animation */
.red-dot-loader {
    width: 12px;
    height: 12px;
    background-color: #ff0000; /* Pure Red */
    border-radius: 50%;
    display: inline-block;
    animation: pulse-red 0.8s ease-in-out infinite;
}

@keyframes pulse-red {
    0% {
        transform: scale(0.8);
        box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7);
    }
    70% {
        transform: scale(1.2);
        box-shadow: 0 0 0 10px rgba(255, 0, 0, 0);
    }
    100% {
        transform: scale(0.8);
        box-shadow: 0 0 0 0 rgba(255, 0, 0, 0);
    }
}

/* Button fix taaki icon/loader center mein rahe */
#feedbackScr button {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 40px;
    height: 40px;
}
/* SABHI MODAL HEADINGS KE LIYE GAP FIX */
.modal h2 {
    margin-bottom: 15px !important;  /* Niche gap dega */
    margin-top: 5px !important;      /* Upar thoda space */
    line-height: 1;                  /* Text height fix */
}

/* Close Icon ki position thodi adjust taaki wo heading se na takraye */
.close-icon {
    margin-top: -5px !important;
}
</style><script>async function sendMsg() {
    const input = document.getElementById('userMsg');
    const btn = document.querySelector('#feedbackScr button');
    const msgText = input.value.trim();

    if (!msgText) return;

    // 1. Message bhejte waqt Button ko lock karo aur Red Loader dikhao
    const originalHTML = btn.innerHTML; // Arrow ko save kar liya
    btn.disabled = true;
    btn.innerHTML = '<span class="red-dot-loader"></span>'; // Red animation yahan aayega

    try {
        const response = await fetch(DB_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                text: msgText,
                timestamp: Date.now()
            })
        });

        if (response.ok) {
            input.value = ""; // Input clear karo
            if (typeof loadMessages === "function") await loadMessages(); // Messages refresh karo
        }
    } catch (e) {
        console.error("Sending failed:", e);
        alert("Message nahi gaya, check net!");
    } finally {
        // 2. Kaam khatam hone par wapas Arrow le aao
        btn.disabled = false;
        btn.innerHTML = originalHTML;
    }
}
async function sendMsg() {
    const input = document.getElementById('userMsg');
    const btn = document.querySelector('#feedbackScr button');
    const msgText = input.value.trim();

    if (!msgText) return;

    const originalHTML = btn.innerHTML;
    btn.disabled = true;
    btn.innerHTML = '<span class="red-dot-loader"></span>';

    try {
        const newEntry = {
            userName: "USER", // Default name jo baad mein admin badal sakta hai
            text: msgText,
            reply: "",
            timestamp: Date.now()
        };

        await fetch(DB_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(newEntry)
        });

        input.value = "";
        await loadMessages();
    } catch (e) {
        console.error("Error:", e);
    } finally {
        btn.disabled = false;
        btn.innerHTML = originalHTML;
    }
}
async function loadMessages() {
    try {
        const res = await fetch(DB_URL);
        const data = await res.json();
        const board = document.getElementById('msgBoard');
        
        if (!data) {
            board.innerHTML = '<p style="opacity:0.4; text-align:center;">NO MESSAGES YET.</p>';
            return;
        }

        const messages = Object.keys(data).map(key => ({ id: key, ...data[key] }));

        board.innerHTML = messages.map(m => `
            <div class="msg-bubble" onclick="adminControl('${m.id}', '${m.userName}')">
                <span class="u-badge">${m.userName || 'USER'}</span> 
                <p style="text-transform:none; margin:5px 0;">${m.text}</p>
                ${m.reply ? `
                    <div class="admin-reply-box">
                        <span class="admin-tag">‚óè ADMIN REPLY</span>
                        <p style="text-transform:none; opacity:0.8;">${m.reply}</p>
                    </div>
                ` : ''}
            </div>
        `).join('');
        
        board.scrollTop = board.scrollHeight;
    } catch (error) { console.log(error); }
}
async function adminControl(msgId, currentName) {
    const pass = prompt("ADMIN PASSWORD:");
    if (pass === "465610") {
        const action = prompt("CHOOSE ACTION: \n1. REPLY \n2. EDIT NAME \n3. DELETE MESSAGE \n4. REMOVE ONLY REPLY");
        const itemUrl = `https://nothingcommunity-7664f-default-rtdb.firebaseio.com/chat/${msgId}.json`;

        if (action === "1") {
            const txt = prompt(`REPLY TO ${currentName}:`);
            if(txt) await fetch(itemUrl, { method: 'PATCH', body: JSON.stringify({ reply: txt }) });
        } 
        else if (action === "2") {
            const newName = prompt("ENTER NEW NAME FOR THIS USER:", currentName);
            if(newName) await fetch(itemUrl, { method: 'PATCH', body: JSON.stringify({ userName: newName.toUpperCase() }) });
        }
        else if (action === "3") {
            if(confirm("DELETE THIS MESSAGE?")) await fetch(itemUrl, { method: 'DELETE' });
        } 
        else if (action === "4") {
            await fetch(itemUrl, { method: 'PATCH', body: JSON.stringify({ reply: "" }) });
        }
        loadMessages();
    } else if (pass !== null) {
        alert("WRONG PASSWORD!");
    }
}
async function generateAIWall() {
    const promptInput = document.getElementById('aiPrompt');
    const ratio = document.getElementById('aiRatio').value;
    const btn = document.getElementById('genBtn');
    const bar = btn.querySelector('.progress-bar');
    const txt = btn.querySelector('.btn-text');
    const resultDiv = document.getElementById('aiResult');
    const aiImg = document.getElementById('aiImg');

    const prompt = promptInput.value.trim();

    if (!prompt) {
        alert("PLEASE ENTER SOMETHING");
        return;
    }

    // 1. UI Loading State
    btn.style.pointerEvents = 'none';
    txt.innerText = 'IMAGINING...';
    bar.style.transition = 'width 30s cubic-bezier(0.4, 0, 0.2, 1)'; // Slow smooth progress
    bar.style.width = '90%';
    
    // Hide previous result if any
    resultDiv.style.display = 'none';
    aiImg.style.opacity = '0';

    // 2. Calculate Dimensions based on ratio
    let width = 1080, height = 1920; // Default 9:16
    if (ratio === "16:9") { width = 1920; height = 1080; }
    if (ratio === "1:1") { width = 1080; height = 1080; }

    // 3. Construct URL (Auto-adding Nothing Style keywords)
    // Random seed ensures every click gives a new image even for same prompt
    const seed = Math.floor(Math.random() * 100000);
    const enhancedPrompt = encodeURIComponent(`${prompt}, nothing technology style, aesthetic, minimalist, high quality, 8k, dark mode`);
    const apiUrl = `https://image.pollinations.ai/prompt/${enhancedPrompt}?width=${width}&height=${height}&seed=${seed}&nologo=true&model=flux`;

    // 4. Load Image
    const tempImg = new Image();
    tempImg.src = apiUrl;
    
    tempImg.onload = () => {
        // Image loaded successfully
        aiImg.src = apiUrl;
        resultDiv.style.display = 'block';
        
        // Slight delay for animation
        setTimeout(() => {
            aiImg.style.opacity = '1';
            resultDiv.scrollIntoView({ behavior: 'smooth' });
            
            // Reset Button
            bar.style.width = '0%';
            bar.style.transition = 'none';
            txt.innerText = 'GENERATE AGAIN';
            btn.style.pointerEvents = 'all';
        }, 100);
    };

    tempImg.onerror = () => {
        alert("SERVER BUSY. TRY AGAIN.");
        bar.style.width = '0%';
        txt.innerText = 'TRY AGAIN';
        btn.style.pointerEvents = 'all';
    };
}

async function downloadAIWall(btn) {
    const imgUrl = document.getElementById('aiImg').src;
    const bar = btn.querySelector('.progress-bar');
    const txt = btn.querySelector('.btn-text');
    const oldTxt = txt.innerText;

    btn.style.pointerEvents = 'none';
    txt.innerText = 'SAVING...';
    bar.style.width = '100%';

    try {
        // Fetch blob to force download (bypassing browser preview)
        const response = await fetch(imgUrl);
        const blob = await response.blob();
        const blobUrl = window.URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = blobUrl;
        a.download = "NothingZones_AI_" + Date.now() + ".jpg";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(blobUrl);

        txt.innerText = "SAVED ‚úì";
    } catch (e) {
        // Fallback if fetch fails (CORS issues)
        window.open(imgUrl, '_blank');
        txt.innerText = "OPENED";
    }

    setTimeout(() => {
        bar.style.width = '0%';
        txt.innerText = oldTxt;
        btn.style.pointerEvents = 'all';
    }, 2000);
}



async function generateAIWall() {
    const promptInput = document.getElementById('aiPrompt');
    const ratio = document.getElementById('aiRatio').value;
    const btn = document.getElementById('genBtn');
    const bar = btn.querySelector('.progress-bar');
    const txt = btn.querySelector('.btn-text');
    const resultDiv = document.getElementById('aiResult');
    const aiImg = document.getElementById('aiImg');

    const prompt = promptInput.value.trim();

    if (!prompt) {
        alert("PLEASE ENTER SOMETHING");
        return;
    }

    // UI Loading State
    btn.style.pointerEvents = 'none';
    txt.innerText = 'IMAGINING...';
    bar.style.transition = 'width 60s cubic-bezier(0.4, 0, 0.2, 1)'; 
    bar.style.width = '90%';
    
    resultDiv.style.display = 'none';
    aiImg.style.opacity = '0';

    let width = 1080, height = 1920; 
    if (ratio === "16:9") { width = 1920; height = 1080; }
    if (ratio === "1:1") { width = 1080; height = 1080; }

    const seed = Math.floor(Math.random() * 100000);
    const enhancedPrompt = encodeURIComponent(`${prompt}, nothing technology style, aesthetic, minimalist, high quality, 8k, dark mode`);
    const apiUrl = `https://image.pollinations.ai/prompt/${enhancedPrompt}?width=${width}&height=${height}&seed=${seed}&nologo=true&model=flux`;

    try {
        const response = await fetch(apiUrl);

        if (!response.ok) throw new Error("Server Error");

        const blob = await response.blob();
        
        // --- YAHAN HAI MAGIC LOGIC ---
        
        // 1 MB = 1,048,576 bytes
        // Logic: Agar image 1MB (1000000 bytes) se badi hai, toh wo pakka Error Poster hai.
        if (blob.size > 1000000) {
             throw new Error("Rate Limit Image Detected (File Too Big)");
        }

        // -----------------------------

        const imgUrl = URL.createObjectURL(blob);
        aiImg.src = imgUrl;
        resultDiv.style.display = 'block';

        setTimeout(() => {
            aiImg.style.opacity = '1';
            resultDiv.scrollIntoView({ behavior: 'smooth' });
            bar.style.width = '0%';
            bar.style.transition = 'none';
            txt.innerText = 'GENERATE AGAIN';
            btn.style.pointerEvents = 'all';
        }, 100);

    } catch (error) {
        console.warn("Generation Skipped:", error.message);
        
        // User ko Alert do ki abhi server busy hai
        alert("SERVER BUSY (High Traffic). TRY IN 30 SECONDS.");
        
        bar.style.width = '0%';
        bar.style.transition = 'none';
        txt.innerText = 'TRY AGAIN';
        btn.style.pointerEvents = 'all';
    }
}
</script>
